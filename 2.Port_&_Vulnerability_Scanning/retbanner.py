#!/usr/bin/python

import socket
import re

def retBanner(ip, port):
    try:
        socket.setdefaulttimeout(2)
        s = socket.socket()
        s.connect((ip,port))
        banner = s.recv(1024)
        s.close()
        if banner: 
            banner = limpiar_banner(banner)
        return banner

    except:
        return None

def limpiar_banner(banner):
    try:
        # Intentar decodificar el banner a utf-8
        banner_str = banner.decode('utf-8')
    except UnicodeDecodeError:
        # Si falla la decodificación, convertir cada byte a su representación hexadecimal
        banner_str = ''.join(f'\\x{byte:02x}' for byte in banner)
    
    # Eliminar los caracteres de salto de línea
    banner_str = re.sub(r'\\r|\\n', '', banner_str)
    
    return banner_str


def main():
    ip = input("[*] Enter target IP: ")
    for port in range(1,100):
        banner = retBanner(ip, port)
        if banner: 
            print("[+]", ip, "port", port, ":", banner)


main()